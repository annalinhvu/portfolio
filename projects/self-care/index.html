<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Only Good Things</title>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}

:root[data-theme="light"]{
  --bg:#faf6f0;
  --surface:#ffffff;
  --surface-2:#f5f0e8;
  --text-1:#2d2a26;
  --text-2:#5c5650;
  --text-3:#8a837a;
  --text-4:#b8b0a4;
  --accent:#7b9e87;
  --accent-2:#c47d5a;
  --accent-3:#d4a0a0;
  --accent-4:#c9a96e;
  --border:#e8e0d6;
  --border-hover:#d4ccc0;
  --shadow:0 2px 8px rgba(0,0,0,0.06);
  --shadow-hover:0 6px 20px rgba(0,0,0,0.1);
  --cat-body:#d4a0a0;
  --cat-mind:#a0b8d4;
  --cat-creative:#c9a96e;
  --cat-nature:#7b9e87;
  --cat-nourish:#c47d5a;
  --cat-rest:#b8a0d4;
}
:root[data-theme="dark"]{
  --bg:#1a1816;
  --surface:#242120;
  --surface-2:#2e2a28;
  --text-1:#e8e2da;
  --text-2:#c4bbb0;
  --text-3:#8a837a;
  --text-4:#5c5650;
  --accent:#9bbaa5;
  --accent-2:#d49a7a;
  --accent-3:#d4a0a0;
  --accent-4:#d4be82;
  --border:#3a3532;
  --border-hover:#4a4540;
  --shadow:0 2px 8px rgba(0,0,0,0.2);
  --shadow-hover:0 6px 20px rgba(0,0,0,0.3);
  --cat-body:#d4a0a0;
  --cat-mind:#a0b8d4;
  --cat-creative:#d4be82;
  --cat-nature:#9bbaa5;
  --cat-nourish:#d49a7a;
  --cat-rest:#c4aee0;
}

body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:var(--bg);color:var(--text-2);
  min-height:100vh;transition:background .3s,color .3s;
  -webkit-font-smoothing:antialiased;
  position:relative;overflow-x:hidden;
}

/* ── Decorative background ── */
.bg-decor{
  position:fixed;top:0;left:0;right:0;bottom:0;
  pointer-events:none;z-index:0;overflow:hidden;
}
.bg-item{
  position:absolute;transition:opacity .3s;
}
.bg-item svg{width:100%;height:100%;display:block}

/* Floating animation */
@keyframes bgFloat{
  0%,100%{transform:translateY(0) rotate(var(--r,0deg))}
  50%{transform:translateY(-8px) rotate(var(--r,0deg))}
}
@keyframes bgFloatSlow{
  0%,100%{transform:translateY(0) rotate(var(--r,0deg))}
  50%{transform:translateY(-5px) rotate(var(--r,0deg))}
}
@keyframes bgSpin{
  0%{transform:rotate(0deg)}
  100%{transform:rotate(360deg)}
}
.bg-float{animation:bgFloat 6s ease-in-out infinite}
.bg-float-slow{animation:bgFloatSlow 8s ease-in-out infinite}

/* Leaves */
.bg-leaf{opacity:.06}
[data-theme="dark"] .bg-leaf{opacity:.04}
.bg-l1{top:3%;left:2%;width:80px;height:80px;--r:-20deg;animation-delay:0s}
.bg-l2{top:22%;right:3%;width:65px;height:65px;--r:30deg;animation-delay:1s}
.bg-l3{top:48%;left:1%;width:70px;height:70px;--r:15deg;animation-delay:2s}
.bg-l4{top:72%;right:2%;width:75px;height:75px;--r:-25deg;animation-delay:.5s}

/* Flowers */
.bg-flower{opacity:.07}
[data-theme="dark"] .bg-flower{opacity:.045}
.bg-f1{top:8%;right:6%;width:45px;height:45px;animation-delay:1.5s}
.bg-f2{top:32%;left:4%;width:35px;height:35px;animation-delay:3s}
.bg-f3{top:58%;right:5%;width:40px;height:40px;animation-delay:0s}
.bg-f4{top:85%;left:3%;width:38px;height:38px;animation-delay:2.5s}
.bg-f5{top:15%;left:8%;width:30px;height:30px;animation-delay:4s}
.bg-f6{top:68%;left:6%;width:32px;height:32px;animation-delay:1s}

/* Stars & moons */
.bg-star{opacity:.06}
[data-theme="dark"] .bg-star{opacity:.08}
.bg-s1{top:5%;right:12%;width:20px;height:20px;animation-delay:2s}
.bg-s2{top:28%;left:7%;width:16px;height:16px;animation-delay:0s}
.bg-s3{top:45%;right:8%;width:18px;height:18px;animation-delay:3s}
.bg-s4{top:78%;right:10%;width:14px;height:14px;animation-delay:1s}
.bg-s5{top:62%;left:3%;width:15px;height:15px;animation-delay:4s}
.bg-s6{top:92%;left:10%;width:17px;height:17px;animation-delay:2.5s}

.bg-moon{opacity:.05}
[data-theme="dark"] .bg-moon{opacity:.07}
.bg-m1{top:12%;left:5%;width:40px;height:40px;animation-delay:1s}
.bg-m2{top:55%;right:4%;width:35px;height:35px;animation-delay:3s}

/* Soft blobs */
.bg-blob{
  position:absolute;border-radius:50%;
  opacity:.05;filter:blur(40px);
  transition:opacity .3s;
}
[data-theme="dark"] .bg-blob{opacity:.035}
.bg-b1{width:250px;height:250px;top:8%;right:5%;background:var(--accent-3)}
.bg-b2{width:200px;height:200px;top:38%;left:2%;background:var(--accent)}
.bg-b3{width:180px;height:180px;top:65%;right:8%;background:var(--accent-4)}
.bg-b4{width:220px;height:220px;top:85%;left:5%;background:var(--accent-2)}

/* ── Page ── */
.page{position:relative;z-index:1}

/* ── Top bar ── */
.topbar{
  position:sticky;top:0;z-index:100;
  display:flex;align-items:center;justify-content:space-between;
  padding:0 28px;height:52px;
  background:var(--surface);border-bottom:1px solid var(--border);
  transition:background .3s,border-color .3s;
}
.topbar-left a{
  color:var(--text-4);text-decoration:none;font-size:.7rem;
  letter-spacing:1px;text-transform:uppercase;transition:color .2s;
}
.topbar-left a:hover{color:var(--accent)}
.topbar-title{
  font-family:Georgia,serif;font-size:1rem;font-weight:400;
  color:var(--text-1);letter-spacing:.5px;
  position:absolute;left:50%;transform:translateX(-50%);
}
.topbar-right{display:flex;align-items:center;gap:8px}
.theme-btn{
  background:none;border:none;cursor:pointer;font-size:1rem;
  color:var(--text-4);padding:4px 8px;transition:color .2s;
}
.theme-btn:hover{color:var(--text-2)}

/* ── Page container ── */
.page{max-width:1400px;margin:0 auto;padding:32px 28px 80px;position:relative;z-index:1}

/* ── Header / tagline ── */
.catalog-header{text-align:center;margin-bottom:36px;padding:20px 0 8px}
.catalog-title{
  font-family:Georgia,serif;font-size:1.6rem;font-weight:400;
  color:var(--text-1);margin-bottom:8px;letter-spacing:.5px;
}
.catalog-tagline{
  font-family:Georgia,serif;font-style:italic;
  font-size:.95rem;color:var(--text-3);letter-spacing:.3px;
  margin-bottom:12px;
}
.catalog-divider{
  width:60px;height:1px;background:var(--accent);
  margin:0 auto;opacity:.4;
}

/* ── Filters ── */
.filters{margin-bottom:24px}
.category-pills{
  display:flex;flex-wrap:wrap;gap:8px;justify-content:center;
  margin-bottom:16px;
}
.cat-pill{
  display:inline-flex;align-items:center;gap:6px;
  padding:6px 14px;border-radius:20px;
  border:1px solid var(--border);background:var(--surface);
  font-size:.75rem;letter-spacing:.5px;text-transform:capitalize;
  color:var(--text-3);cursor:pointer;transition:all .2s;
  user-select:none;
}
.cat-pill:hover{border-color:var(--border-hover)}
.cat-pill .dot{
  width:8px;height:8px;border-radius:50%;
  transition:transform .2s;
}
.cat-pill.active{
  border-color:var(--text-3);color:var(--text-1);
  background:var(--surface-2);
}
.cat-pill.active .dot{transform:scale(1.3)}

.filter-row{
  display:flex;gap:10px;justify-content:center;flex-wrap:wrap;
}
.filter-select{
  padding:7px 14px;border-radius:8px;
  border:1px solid var(--border);background:var(--surface);
  font-size:.78rem;color:var(--text-2);
  cursor:pointer;transition:border-color .2s;
  -webkit-appearance:none;appearance:none;
  background-image:url("data:image/svg+xml,%3Csvg width='10' height='6' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%238a837a'/%3E%3C/svg%3E");
  background-repeat:no-repeat;background-position:right 10px center;
  padding-right:28px;
}
.filter-select:hover,.filter-select:focus{border-color:var(--accent);outline:none}
.search-input{
  padding:7px 14px;border-radius:8px;
  border:1px solid var(--border);background:var(--surface);
  font-size:.78rem;color:var(--text-2);width:200px;
  transition:border-color .2s;
}
.search-input::placeholder{color:var(--text-4)}
.search-input:hover,.search-input:focus{border-color:var(--accent);outline:none}

/* ── Count ── */
.result-count{
  font-size:.78rem;color:var(--text-4);margin-bottom:20px;
  letter-spacing:.5px;
}

/* ── Card grid ── */
.card-grid{
  display:grid;grid-template-columns:repeat(4,1fr);gap:16px;
}
@media(max-width:1100px){.card-grid{grid-template-columns:repeat(3,1fr)}}
@media(max-width:800px){.card-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.card-grid{grid-template-columns:1fr}}

/* ── Activity card ── */
.activity-card{
  background:var(--surface);border:1px solid var(--border);
  border-radius:8px;padding:20px 22px 18px;
  border-top:3px solid var(--border);
  cursor:pointer;transition:all .25s;
  box-shadow:var(--shadow);
  display:flex;flex-direction:column;
}
.activity-card:hover{
  transform:translateY(-2px);
  box-shadow:var(--shadow-hover);
}
.card-category{
  font-size:.62rem;letter-spacing:1.5px;text-transform:uppercase;
  font-weight:600;margin-bottom:8px;
}
.card-name{
  font-family:Georgia,serif;font-size:1rem;font-weight:400;
  color:var(--text-1);margin-bottom:6px;line-height:1.3;
}
.card-tagline{
  font-family:Georgia,serif;font-style:italic;
  font-size:.82rem;color:var(--text-3);margin-bottom:auto;
  line-height:1.5;padding-bottom:14px;
}
.card-meta{
  display:flex;gap:6px;flex-wrap:wrap;align-items:center;
  font-size:.68rem;color:var(--text-4);letter-spacing:.3px;
  padding-top:12px;border-top:1px solid var(--border);
}
.card-meta span{display:inline-flex;align-items:center;gap:3px}
.meta-sep{color:var(--border)}

/* ── Detail view ── */
.detail-view{display:none}
.detail-view.active{display:block}
.catalog-view.hidden{display:none}

.detail-back{
  display:inline-flex;align-items:center;gap:6px;
  font-size:.78rem;color:var(--text-3);text-decoration:none;
  cursor:pointer;margin-bottom:24px;transition:color .2s;
  background:none;border:none;font-family:inherit;
}
.detail-back:hover{color:var(--accent)}

.detail-header{margin-bottom:28px}
.detail-category{
  font-size:.65rem;letter-spacing:1.5px;text-transform:uppercase;
  font-weight:600;margin-bottom:8px;display:inline-block;
}
.detail-name{
  font-family:Georgia,serif;font-size:1.8rem;font-weight:400;
  color:var(--text-1);margin-bottom:8px;line-height:1.2;
}
.detail-tagline{
  font-family:Georgia,serif;font-style:italic;
  font-size:1.05rem;color:var(--text-3);margin-bottom:16px;
}
.detail-badges{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:24px}
.badge{
  padding:4px 12px;border-radius:20px;font-size:.68rem;
  letter-spacing:.5px;border:1px solid var(--border);
  color:var(--text-3);text-transform:capitalize;
}

.detail-body{
  display:grid;grid-template-columns:2fr 1fr;gap:32px;
}
@media(max-width:700px){.detail-body{grid-template-columns:1fr}}

.detail-description{
  font-size:.92rem;color:var(--text-2);line-height:1.8;
  margin-bottom:28px;
}

.detail-section{margin-bottom:24px}
.detail-section-title{
  font-size:.65rem;letter-spacing:1.5px;text-transform:uppercase;
  color:var(--accent);margin-bottom:12px;font-weight:600;
}
.detail-supplies{
  list-style:none;
}
.detail-supplies li{
  font-size:.85rem;color:var(--text-2);padding:4px 0;
  padding-left:16px;position:relative;line-height:1.6;
}
.detail-supplies li::before{
  content:'';position:absolute;left:2px;top:11px;
  width:6px;height:6px;border-radius:50%;
  background:var(--accent);opacity:.5;
}
.detail-instructions{
  list-style:none;counter-reset:steps;
}
.detail-instructions li{
  font-size:.85rem;color:var(--text-2);padding:6px 0;
  padding-left:28px;position:relative;line-height:1.7;
  counter-increment:steps;
}
.detail-instructions li::before{
  content:counter(steps);position:absolute;left:0;top:6px;
  font-family:Georgia,serif;font-size:.82rem;
  color:var(--accent);font-weight:400;
  width:20px;text-align:center;
}

.detail-meta{
  background:var(--surface-2);border-radius:8px;padding:20px;
  height:fit-content;
}
.meta-item{
  display:flex;justify-content:space-between;align-items:center;
  padding:8px 0;border-bottom:1px solid var(--border);
  font-size:.8rem;
}
.meta-item:last-child{border-bottom:none}
.meta-label{color:var(--text-3);text-transform:capitalize}
.meta-value{color:var(--text-1);font-weight:500;text-transform:capitalize}

/* ── Footer ── */
.catalog-footer{
  text-align:center;padding:48px 0 20px;
  color:var(--text-4);font-size:.72rem;
  letter-spacing:.5px;
}
.catalog-footer .footer-leaf{
  display:inline-block;margin-bottom:12px;opacity:.15;
}
.catalog-footer .footer-leaf svg{width:28px;height:28px}
.catalog-footer p{line-height:1.8}

/* ── Completion tracking ── */
.done-badge{
  position:absolute;top:12px;right:12px;
  width:22px;height:22px;border-radius:50%;
  background:var(--accent);color:#fff;
  display:flex;align-items:center;justify-content:center;
  font-size:.7rem;font-weight:700;
  opacity:.85;
}
.activity-card{position:relative}
.done-count{
  font-size:.6rem;color:var(--accent);font-weight:600;
  margin-left:auto;padding-left:8px;white-space:nowrap;
}

/* Mark done form */
.mark-done-section{
  margin-top:28px;padding:20px;
  background:var(--surface-2);border-radius:8px;
}
.mark-done-title{
  font-size:.65rem;letter-spacing:1.5px;text-transform:uppercase;
  color:var(--accent);margin-bottom:12px;font-weight:600;
}
.mark-done-row{
  display:flex;gap:10px;align-items:flex-end;flex-wrap:wrap;
}
.mark-done-field{display:flex;flex-direction:column;gap:4px}
.mark-done-field label{
  font-size:.68rem;color:var(--text-3);text-transform:uppercase;
  letter-spacing:.5px;
}
.mark-done-field input{
  padding:7px 12px;border-radius:6px;
  border:1px solid var(--border);background:var(--surface);
  font-size:.8rem;color:var(--text-2);
}
.mark-done-field input:focus{border-color:var(--accent);outline:none}
.mark-done-btn{
  padding:8px 20px;border-radius:6px;
  background:var(--accent);color:#fff;
  border:none;font-size:.78rem;font-weight:500;
  cursor:pointer;transition:background .2s;
  white-space:nowrap;
}
.mark-done-btn:hover{opacity:.9}

/* Completion log */
.completion-log{margin-top:16px}
.completion-entry{
  display:flex;justify-content:space-between;align-items:center;
  padding:8px 0;border-bottom:1px solid var(--border);
  font-size:.8rem;
}
.completion-entry:last-child{border-bottom:none}
.completion-date{color:var(--text-1);font-weight:500}
.completion-notes{color:var(--text-3);font-style:italic;flex:1;margin:0 12px}
.completion-delete{
  background:none;border:none;color:var(--text-4);
  cursor:pointer;font-size:.7rem;padding:4px 8px;
  transition:color .2s;border-radius:4px;
}
.completion-delete:hover{color:var(--accent-2)}

/* ── Empty state ── */
.empty-state{
  text-align:center;padding:60px 20px;
  color:var(--text-4);
}
.empty-state .empty-icon{
  font-size:2rem;margin-bottom:12px;opacity:.3;
}
.empty-state p{
  font-family:Georgia,serif;font-style:italic;
  font-size:.9rem;
}

/* ── Progress view ── */
.progress-view{display:none}
.progress-view.active{display:block}

.progress-header{text-align:center;margin-bottom:32px;padding:20px 0 8px}
.progress-title{
  font-family:Georgia,serif;font-size:1.6rem;font-weight:400;
  color:var(--text-1);margin-bottom:8px;letter-spacing:.5px;
}
.progress-tagline{
  font-family:Georgia,serif;font-style:italic;
  font-size:.95rem;color:var(--text-3);letter-spacing:.3px;
  margin-bottom:12px;
}

.stat-cards{
  display:grid;grid-template-columns:repeat(4,1fr);gap:16px;
  margin-bottom:32px;
}
@media(max-width:800px){.stat-cards{grid-template-columns:repeat(2,1fr)}}
@media(max-width:480px){.stat-cards{grid-template-columns:1fr}}

.stat-card{
  background:var(--surface);border:1px solid var(--border);
  border-radius:8px;padding:20px;text-align:center;
  box-shadow:var(--shadow);
}
.stat-number{
  font-family:Georgia,serif;font-size:2rem;font-weight:400;
  color:var(--text-1);line-height:1.2;
}
.stat-label{
  font-size:.72rem;letter-spacing:.8px;text-transform:uppercase;
  color:var(--text-3);margin-top:4px;
}

.progress-section{margin-bottom:32px}
.progress-section-title{
  font-size:.65rem;letter-spacing:1.5px;text-transform:uppercase;
  color:var(--accent);margin-bottom:16px;font-weight:600;
}

.category-bars{display:flex;flex-direction:column;gap:12px}
.cat-bar-row{display:flex;align-items:center;gap:12px}
.cat-bar-label{
  font-size:.8rem;color:var(--text-2);text-transform:capitalize;
  width:80px;text-align:right;flex-shrink:0;
}
.cat-bar-track{
  flex:1;height:20px;background:var(--surface-2);
  border-radius:10px;overflow:hidden;
}
.cat-bar-fill{
  height:100%;border-radius:10px;
  transition:width .5s ease;min-width:2px;
}
.cat-bar-count{
  font-size:.75rem;color:var(--text-3);width:32px;flex-shrink:0;
}

.recent-list{display:flex;flex-direction:column;gap:0}
.recent-item{
  display:flex;align-items:center;gap:12px;
  padding:10px 0;border-bottom:1px solid var(--border);
  font-size:.85rem;
}
.recent-item:last-child{border-bottom:none}
.recent-dot{
  width:8px;height:8px;border-radius:50%;flex-shrink:0;
}
.recent-name{
  color:var(--text-1);cursor:pointer;flex-shrink:0;
}
.recent-name:hover{color:var(--accent);text-decoration:underline}
.recent-notes{
  color:var(--text-3);font-style:italic;flex:1;
  overflow:hidden;text-overflow:ellipsis;white-space:nowrap;
}
.recent-date{
  color:var(--text-4);font-size:.75rem;flex-shrink:0;
}

.progress-empty{
  text-align:center;padding:60px 20px;color:var(--text-4);
}
.progress-empty p{
  font-family:Georgia,serif;font-style:italic;
  font-size:.95rem;margin-bottom:16px;line-height:1.6;
}
.progress-empty a{
  color:var(--accent);text-decoration:none;
  font-size:.85rem;
}
.progress-empty a:hover{text-decoration:underline}

/* ── Topbar nav ── */
.topbar-nav{display:flex;align-items:center;gap:12px}
.topbar-nav a{
  color:var(--text-4);text-decoration:none;font-size:.7rem;
  letter-spacing:1px;text-transform:uppercase;transition:color .2s;
}
.topbar-nav a:hover{color:var(--accent)}
.topbar-nav .nav-sep{color:var(--border);font-size:.6rem}

/* ── Animations ── */
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
.fade-in{animation:fadeIn .3s ease forwards}

/* ── Responsive ── */
@media(max-width:600px){
  .topbar{padding:0 16px}
  .topbar-title{font-size:.88rem}
  .page{padding:20px 16px 60px}
  .detail-name{font-size:1.4rem}
  .search-input{width:100%}
  .filter-row{flex-direction:column;align-items:stretch}
  .bg-decor{display:none}
}
</style>
</head>
<body>

<div class="topbar">
  <div class="topbar-left topbar-nav">
    <a href="../../index.html#lab">&larr; Portfolio</a>
    <span class="nav-sep">/</span>
    <a href="#catalog">Catalog</a>
    <span class="nav-sep">/</span>
    <a href="#progress">My Progress</a>
  </div>
  <div class="topbar-title">Only Good Things</div>
  <div class="topbar-right">
    <button class="theme-btn" onclick="toggleTheme()" aria-label="Toggle theme"></button>
  </div>
</div>

<!-- Decorative background -->
<div class="bg-decor">
  <!-- Leaves with veins -->
  <div class="bg-item bg-leaf bg-l1 bg-float"><svg viewBox="0 0 100 100"><path d="M50 5 C15 30, 8 65, 50 95 C92 65, 85 30, 50 5Z" fill="var(--accent)"/><path d="M50 15 L50 85" stroke="var(--bg)" stroke-width=".8" fill="none"/><path d="M50 35 L30 22M50 50 L25 40M50 65 L28 57M50 35 L70 22M50 50 L75 40M50 65 L72 57" stroke="var(--bg)" stroke-width=".4" fill="none"/></svg></div>
  <div class="bg-item bg-leaf bg-l2 bg-float-slow"><svg viewBox="0 0 100 100"><path d="M50 5 C15 30, 8 65, 50 95 C92 65, 85 30, 50 5Z" fill="var(--accent-2)"/><path d="M50 15 L50 85" stroke="var(--bg)" stroke-width=".8" fill="none"/><path d="M50 38 L32 26M50 55 L28 46M50 38 L68 26M50 55 L72 46" stroke="var(--bg)" stroke-width=".4" fill="none"/></svg></div>
  <div class="bg-item bg-leaf bg-l3 bg-float"><svg viewBox="0 0 80 120"><ellipse cx="40" cy="60" rx="20" ry="52" fill="var(--accent-3)"/><path d="M40 12 L40 108" stroke="var(--bg)" stroke-width=".6" fill="none"/></svg></div>
  <div class="bg-item bg-leaf bg-l4 bg-float-slow"><svg viewBox="0 0 100 100"><path d="M50 5 C15 30, 8 65, 50 95 C92 65, 85 30, 50 5Z" fill="var(--accent-4)"/><path d="M50 15 L50 85" stroke="var(--bg)" stroke-width=".8" fill="none"/><path d="M50 40 L30 28M50 58 L26 48M50 40 L70 28M50 58 L74 48" stroke="var(--bg)" stroke-width=".4" fill="none"/></svg></div>

  <!-- Flowers — 5 petals -->
  <div class="bg-item bg-flower bg-f1 bg-float-slow"><svg viewBox="0 0 100 100"><circle cx="50" cy="30" r="16" fill="var(--accent-3)"/><circle cx="69" cy="44" r="16" fill="var(--accent-3)"/><circle cx="62" cy="67" r="16" fill="var(--accent-3)"/><circle cx="38" cy="67" r="16" fill="var(--accent-3)"/><circle cx="31" cy="44" r="16" fill="var(--accent-3)"/><circle cx="50" cy="50" r="10" fill="var(--accent-4)"/></svg></div>
  <div class="bg-item bg-flower bg-f2 bg-float"><svg viewBox="0 0 100 100"><circle cx="50" cy="30" r="14" fill="var(--accent)"/><circle cx="67" cy="43" r="14" fill="var(--accent)"/><circle cx="60" cy="65" r="14" fill="var(--accent)"/><circle cx="40" cy="65" r="14" fill="var(--accent)"/><circle cx="33" cy="43" r="14" fill="var(--accent)"/><circle cx="50" cy="49" r="8" fill="var(--accent-4)"/></svg></div>
  <div class="bg-item bg-flower bg-f3 bg-float-slow"><svg viewBox="0 0 100 100"><circle cx="50" cy="32" r="15" fill="var(--accent-2)"/><circle cx="68" cy="44" r="15" fill="var(--accent-2)"/><circle cx="61" cy="66" r="15" fill="var(--accent-2)"/><circle cx="39" cy="66" r="15" fill="var(--accent-2)"/><circle cx="32" cy="44" r="15" fill="var(--accent-2)"/><circle cx="50" cy="50" r="9" fill="var(--accent-4)"/></svg></div>
  <div class="bg-item bg-flower bg-f4 bg-float"><svg viewBox="0 0 100 100"><circle cx="50" cy="30" r="14" fill="var(--accent-3)"/><circle cx="67" cy="43" r="14" fill="var(--accent-3)"/><circle cx="60" cy="65" r="14" fill="var(--accent-3)"/><circle cx="40" cy="65" r="14" fill="var(--accent-3)"/><circle cx="33" cy="43" r="14" fill="var(--accent-3)"/><circle cx="50" cy="49" r="8" fill="var(--accent-2)"/></svg></div>
  <!-- Tiny daisies -->
  <div class="bg-item bg-flower bg-f5 bg-float"><svg viewBox="0 0 100 100"><ellipse cx="50" cy="28" rx="8" ry="18" fill="var(--accent)"/><ellipse cx="50" cy="72" rx="8" ry="18" fill="var(--accent)"/><ellipse cx="28" cy="50" rx="18" ry="8" fill="var(--accent)"/><ellipse cx="72" cy="50" rx="18" ry="8" fill="var(--accent)"/><circle cx="50" cy="50" r="7" fill="var(--accent-4)"/></svg></div>
  <div class="bg-item bg-flower bg-f6 bg-float-slow"><svg viewBox="0 0 100 100"><ellipse cx="50" cy="28" rx="8" ry="18" fill="var(--accent-2)"/><ellipse cx="50" cy="72" rx="8" ry="18" fill="var(--accent-2)"/><ellipse cx="28" cy="50" rx="18" ry="8" fill="var(--accent-2)"/><ellipse cx="72" cy="50" rx="18" ry="8" fill="var(--accent-2)"/><circle cx="50" cy="50" r="7" fill="var(--accent-3)"/></svg></div>

  <!-- Stars -->
  <div class="bg-item bg-star bg-s1 bg-float"><svg viewBox="0 0 100 100"><polygon points="50,5 61,38 95,38 67,59 78,93 50,72 22,93 33,59 5,38 39,38" fill="var(--accent-4)"/></svg></div>
  <div class="bg-item bg-star bg-s2 bg-float-slow"><svg viewBox="0 0 100 100"><polygon points="50,5 61,38 95,38 67,59 78,93 50,72 22,93 33,59 5,38 39,38" fill="var(--accent-3)"/></svg></div>
  <div class="bg-item bg-star bg-s3 bg-float"><svg viewBox="0 0 100 100"><polygon points="50,5 61,38 95,38 67,59 78,93 50,72 22,93 33,59 5,38 39,38" fill="var(--accent)"/></svg></div>
  <div class="bg-item bg-star bg-s4 bg-float-slow"><svg viewBox="0 0 100 100"><polygon points="50,5 61,38 95,38 67,59 78,93 50,72 22,93 33,59 5,38 39,38" fill="var(--accent-2)"/></svg></div>
  <!-- Tiny sparkles (4-point stars) -->
  <div class="bg-item bg-star bg-s5 bg-float"><svg viewBox="0 0 100 100"><path d="M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45Z" fill="var(--accent-4)"/></svg></div>
  <div class="bg-item bg-star bg-s6 bg-float-slow"><svg viewBox="0 0 100 100"><path d="M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45Z" fill="var(--accent-3)"/></svg></div>

  <!-- Crescent moons -->
  <div class="bg-item bg-moon bg-m1 bg-float-slow"><svg viewBox="0 0 100 100"><path d="M60 10 A40 40 0 1 0 60 90 A30 30 0 1 1 60 10Z" fill="var(--accent-4)"/></svg></div>
  <div class="bg-item bg-moon bg-m2 bg-float"><svg viewBox="0 0 100 100"><path d="M60 10 A40 40 0 1 0 60 90 A30 30 0 1 1 60 10Z" fill="var(--accent-3)"/></svg></div>

  <!-- Soft gradient blobs -->
  <div class="bg-blob bg-b1"></div>
  <div class="bg-blob bg-b2"></div>
  <div class="bg-blob bg-b3"></div>
  <div class="bg-blob bg-b4"></div>
</div>

<div class="page">

  <!-- Catalog View -->
  <div class="catalog-view" id="catalogView">
    <div class="catalog-header">
      <p class="catalog-tagline">a catalog of small rituals &amp; gentle acts</p>
      <div class="catalog-divider"></div>
    </div>

    <div class="filters">
      <div class="category-pills" id="categoryPills"></div>
      <div class="filter-row">
        <select class="filter-select" id="seasonFilter">
          <option value="">All seasons</option>
          <option value="spring">Spring</option>
          <option value="summer">Summer</option>
          <option value="fall">Fall</option>
          <option value="winter">Winter</option>
        </select>
        <select class="filter-select" id="durationFilter">
          <option value="">Any duration</option>
          <option value="quick">Quick (&le;15 min)</option>
          <option value="medium">Medium (30 min)</option>
          <option value="long">Long (60+ min)</option>
        </select>
        <select class="filter-select" id="settingFilter">
          <option value="">Any setting</option>
          <option value="indoor">Indoor</option>
          <option value="outdoor">Outdoor</option>
        </select>
        <input type="search" class="search-input" id="searchInput" placeholder="Search activities...">
      </div>
    </div>

    <div class="result-count" id="resultCount"></div>
    <div class="card-grid" id="cardGrid"></div>

    <div class="catalog-footer">
      <div class="footer-leaf"><svg viewBox="0 0 100 100"><path d="M50 10 C20 30, 10 60, 50 90 C90 60, 80 30, 50 10Z" fill="currentColor" style="color:var(--accent)"/><path d="M50 20 L50 80" stroke="currentColor" stroke-width="1" fill="none" style="color:var(--accent)"/></svg></div>
      <p>curated with care &amp; good intentions</p>
    </div>
  </div>

  <!-- Detail View -->
  <div class="detail-view" id="detailView">
    <button class="detail-back" onclick="showCatalog()">&larr; Back to catalog</button>
    <div id="detailContent"></div>
  </div>

  <!-- Progress View -->
  <div class="progress-view" id="progressView">
    <div class="progress-header">
      <div class="progress-title">My Progress</div>
      <p class="progress-tagline">every small act of care adds up</p>
      <div class="catalog-divider"></div>
    </div>
    <div id="progressContent"></div>
  </div>

</div>

<script>
const CAT_COLORS = {
  body: 'var(--cat-body)',
  mind: 'var(--cat-mind)',
  creative: 'var(--cat-creative)',
  nature: 'var(--cat-nature)',
  nourish: 'var(--cat-nourish)',
  rest: 'var(--cat-rest)',
};
const CAT_ICONS = {
  body: '\u2022',
  mind: '\u2022',
  creative: '\u2022',
  nature: '\u2022',
  nourish: '\u2022',
  rest: '\u2022',
};

let allActivities = [];
let activeCategories = new Set();
let searchTimeout = null;
let completionMap = {}; /* activity_id -> [{id, completed_at, notes}] */

/* ── Theme ── */
function toggleTheme() {
  const html = document.documentElement;
  const next = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('ogt-theme', next);
  updateThemeBtn(next);
}
function updateThemeBtn(t) {
  document.querySelector('.theme-btn').textContent = t === 'dark' ? '\u2600' : '\u263E';
}

/* ── localStorage completions ── */
function getCompletions() {
  try { return JSON.parse(localStorage.getItem('ogt-completions') || '[]'); }
  catch { return []; }
}
function saveCompletions(list) {
  localStorage.setItem('ogt-completions', JSON.stringify(list));
}
function loadCompletionMap() {
  completionMap = {};
  getCompletions().forEach(c => {
    if (!completionMap[c.activity_id]) completionMap[c.activity_id] = [];
    completionMap[c.activity_id].push(c);
  });
}

/* ── Data loading ── */
async function fetchActivities() {
  loadCompletionMap();
  const res = await fetch('data/activities.json');
  allActivities = await res.json();
  buildCategoryPills();
  applyFilters();
}

/* ── Category pills ── */
function buildCategoryPills() {
  const cats = [...new Set(allActivities.map(a => a.category))].sort();
  const container = document.getElementById('categoryPills');
  container.innerHTML = '';
  cats.forEach(cat => {
    const pill = document.createElement('button');
    pill.className = 'cat-pill active';
    pill.dataset.cat = cat;
    pill.innerHTML = '<span class="dot" style="background:' + CAT_COLORS[cat] + '"></span>' + cat;
    pill.onclick = () => toggleCategory(cat, pill);
    container.appendChild(pill);
    activeCategories.add(cat);
  });
}

function toggleCategory(cat, pill) {
  if (activeCategories.has(cat)) {
    activeCategories.delete(cat);
    pill.classList.remove('active');
  } else {
    activeCategories.add(cat);
    pill.classList.add('active');
  }
  applyFilters();
}

/* ── Filtering ── */
function applyFilters() {
  const season = document.getElementById('seasonFilter').value;
  const duration = document.getElementById('durationFilter').value;
  const setting = document.getElementById('settingFilter').value;
  const search = document.getElementById('searchInput').value.toLowerCase().trim();

  let filtered = allActivities.filter(a => {
    if (!activeCategories.has(a.category)) return false;
    if (season && a.season !== season && a.season !== 'all') return false;
    if (setting && a.setting !== setting && a.setting !== 'either') return false;
    if (duration) {
      if (duration === 'quick' && a.duration_min > 15) return false;
      if (duration === 'medium' && (a.duration_min < 20 || a.duration_min > 45)) return false;
      if (duration === 'long' && a.duration_min < 60) return false;
    }
    if (search) {
      const haystack = (a.name + ' ' + a.description + ' ' + a.tagline).toLowerCase();
      if (!haystack.includes(search)) return false;
    }
    return true;
  });

  renderCards(filtered);
  document.getElementById('resultCount').textContent = filtered.length + ' activit' + (filtered.length === 1 ? 'y' : 'ies');
}

/* ── Card rendering ── */
function renderCards(activities) {
  const grid = document.getElementById('cardGrid');
  grid.innerHTML = '';
  if (activities.length === 0) {
    grid.innerHTML = '<div class="empty-state" style="grid-column:1/-1"><div class="empty-icon">\u2E2E</div><p>No activities match your filters — try broadening your search</p></div>';
    return;
  }
  activities.forEach((a, i) => {
    const card = document.createElement('div');
    card.className = 'activity-card fade-in';
    card.style.animationDelay = (i * 0.03) + 's';
    card.style.borderTopColor = CAT_COLORS[a.category];
    card.onclick = () => showDetail(a.id);
    const doneCount = (completionMap[a.id] || []).length;
    card.innerHTML =
      (doneCount ? '<div class="done-badge" title="Done ' + doneCount + ' time' + (doneCount > 1 ? 's' : '') + '">' + doneCount + '</div>' : '') +
      '<div class="card-category" style="color:' + CAT_COLORS[a.category] + '">' + a.category + '</div>' +
      '<div class="card-name">' + esc(a.name) + '</div>' +
      '<div class="card-tagline">' + esc(a.tagline) + '</div>' +
      '<div class="card-meta">' +
        '<span>' + a.duration_min + ' min</span>' +
        '<span class="meta-sep">&middot;</span>' +
        '<span>' + a.season + '</span>' +
        '<span class="meta-sep">&middot;</span>' +
        '<span>' + a.difficulty + '</span>' +
      '</div>';
    grid.appendChild(card);
  });
}

/* ── Detail view ── */
function showDetail(id) {
  const a = allActivities.find(x => x.id === id);
  if (!a) return;

  location.hash = 'activity/' + id;

  document.getElementById('catalogView').classList.add('hidden');
  document.getElementById('progressView').classList.remove('active');
  const dv = document.getElementById('detailView');
  dv.classList.add('active');

  const supplies = (a.supplies || '').split(',').map(s => s.trim()).filter(Boolean);
  const instructions = (a.instructions || '').split('\n').filter(s => s.trim());

  const moonLabels = {new:'New Moon',full:'Full Moon',waxing:'Waxing',waning:'Waning',any:'Any phase'};

  document.getElementById('detailContent').innerHTML =
    '<div class="detail-header fade-in">' +
      '<div class="detail-category" style="color:' + CAT_COLORS[a.category] + '">' + a.category + '</div>' +
      '<div class="detail-name">' + esc(a.name) + '</div>' +
      '<div class="detail-tagline">' + esc(a.tagline) + '</div>' +
      '<div class="detail-badges">' +
        '<span class="badge">' + a.benefit + '</span>' +
        '<span class="badge">' + a.difficulty + '</span>' +
        '<span class="badge">' + a.setting + '</span>' +
      '</div>' +
    '</div>' +
    '<div class="detail-body">' +
      '<div class="detail-main fade-in" style="animation-delay:.05s">' +
        '<div class="detail-description">' + esc(a.description) + '</div>' +
        (supplies.length ? (
          '<div class="detail-section">' +
            '<div class="detail-section-title">You\'ll need</div>' +
            '<ul class="detail-supplies">' + supplies.map(s => '<li>' + esc(s) + '</li>').join('') + '</ul>' +
          '</div>'
        ) : '') +
        '<div class="detail-section">' +
          '<div class="detail-section-title">How to</div>' +
          '<ol class="detail-instructions">' + instructions.map(s => '<li>' + esc(s.replace(/^\d+\.\s*/, '')) + '</li>').join('') + '</ol>' +
        '</div>' +
      '</div>' +
      '<div class="detail-meta fade-in" style="animation-delay:.1s">' +
        '<div class="meta-item"><span class="meta-label">Duration</span><span class="meta-value">' + a.duration_min + ' min</span></div>' +
        '<div class="meta-item"><span class="meta-label">Difficulty</span><span class="meta-value">' + a.difficulty + '</span></div>' +
        '<div class="meta-item"><span class="meta-label">Season</span><span class="meta-value">' + a.season + '</span></div>' +
        '<div class="meta-item"><span class="meta-label">Setting</span><span class="meta-value">' + a.setting + '</span></div>' +
        '<div class="meta-item"><span class="meta-label">Benefit</span><span class="meta-value">' + a.benefit + '</span></div>' +
        '<div class="meta-item"><span class="meta-label">Moon phase</span><span class="meta-value">' + (moonLabels[a.moon_phase] || a.moon_phase) + '</span></div>' +
      '</div>' +
    '</div>';

  /* Completion log & mark-done form */
  const completions = completionMap[a.id] || [];
  const today = new Date().toISOString().split('T')[0];
  const logHtml = completions.length ? (
    '<div class="completion-log">' +
      completions.map(c =>
        '<div class="completion-entry">' +
          '<span class="completion-date">' + formatDate(c.completed_at) + '</span>' +
          '<span class="completion-notes">' + (c.notes ? esc(c.notes) : '') + '</span>' +
          '<button class="completion-delete" onclick="deleteCompletion(' + c.id + ',' + a.id + ')" title="Remove">\u2715</button>' +
        '</div>'
      ).join('') +
    '</div>'
  ) : '<p style="font-size:.8rem;color:var(--text-4);margin-top:8px;font-style:italic">Not done yet — give it a try!</p>';

  document.getElementById('detailContent').innerHTML +=
    '<div class="mark-done-section fade-in" style="animation-delay:.15s">' +
      '<div class="mark-done-title">Track this activity</div>' +
      '<div class="mark-done-row">' +
        '<div class="mark-done-field">' +
          '<label>Date</label>' +
          '<input type="date" id="doneDate" value="' + today + '">' +
        '</div>' +
        '<div class="mark-done-field" style="flex:1">' +
          '<label>Notes (optional)</label>' +
          '<input type="text" id="doneNotes" placeholder="How was it?">' +
        '</div>' +
        '<button class="mark-done-btn" onclick="markDone(' + a.id + ')">Done!</button>' +
      '</div>' +
      logHtml +
    '</div>';

  window.scrollTo(0, 0);
}

function formatDate(d) {
  if (!d) return '';
  const parts = d.split('-');
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  return months[parseInt(parts[1])-1] + ' ' + parseInt(parts[2]) + ', ' + parts[0];
}

function markDone(activityId) {
  const date = document.getElementById('doneDate').value;
  const notes = document.getElementById('doneNotes').value.trim();
  if (!date) return;
  const list = getCompletions();
  const nextId = list.length ? Math.max(...list.map(c => c.id)) + 1 : 1;
  list.push({id: nextId, activity_id: activityId, completed_at: date, notes: notes || null});
  saveCompletions(list);
  loadCompletionMap();
  showDetail(activityId);
}

function deleteCompletion(completionId, activityId) {
  const list = getCompletions().filter(c => c.id !== completionId);
  saveCompletions(list);
  loadCompletionMap();
  showDetail(activityId);
}

function showCatalog() {
  location.hash = 'catalog';
  document.getElementById('detailView').classList.remove('active');
  document.getElementById('progressView').classList.remove('active');
  document.getElementById('catalogView').classList.remove('hidden');
  applyFilters();
}

/* ── Hash routing ── */
function handleHash() {
  const hash = location.hash.replace('#', '');
  if (hash.startsWith('activity/')) {
    const id = parseInt(hash.split('/')[1]);
    if (id) showDetail(id);
  } else if (hash === 'progress') {
    showProgress();
  } else {
    showCatalog();
  }
}

/* ── Stats computation (client-side) ── */
function computeStats() {
  const completions = getCompletions();
  const total_completions = completions.length;
  const unique_activities = new Set(completions.map(c => c.activity_id)).size;
  const total_activities = allActivities.length;

  const today = new Date();
  const weekAgo = new Date(today);
  weekAgo.setDate(weekAgo.getDate() - 7);
  const weekAgoStr = weekAgo.toISOString().split('T')[0];
  const this_week = completions.filter(c => c.completed_at >= weekAgoStr).length;

  /* Streak: consecutive days with at least one completion, from today backwards */
  const daySet = new Set(completions.map(c => c.completed_at));
  let streak_days = 0;
  const check = new Date(today);
  while (daySet.has(check.toISOString().split('T')[0])) {
    streak_days++;
    check.setDate(check.getDate() - 1);
  }

  /* By category */
  const actMap = {};
  allActivities.forEach(a => { actMap[a.id] = a; });
  const catCounts = {};
  completions.forEach(c => {
    const a = actMap[c.activity_id];
    if (a) {
      catCounts[a.category] = (catCounts[a.category] || 0) + 1;
    }
  });
  const by_category = Object.entries(catCounts)
    .map(([category, count]) => ({category, count}))
    .sort((a, b) => b.count - a.count);

  /* Recent 15 */
  const sorted = [...completions].sort((a, b) => {
    if (b.completed_at !== a.completed_at) return b.completed_at < a.completed_at ? -1 : 1;
    return b.id - a.id;
  });
  const recent = sorted.slice(0, 15).map(c => {
    const a = actMap[c.activity_id] || {};
    return {id: c.id, activity_id: c.activity_id, name: a.name || '', category: a.category || '', completed_at: c.completed_at, notes: c.notes};
  });

  return {total_completions, unique_activities, total_activities, this_week, streak_days, by_category, recent};
}

/* ── Progress view ── */
function showProgress() {
  location.hash = 'progress';
  document.getElementById('catalogView').classList.add('hidden');
  document.getElementById('detailView').classList.remove('active');
  document.getElementById('progressView').classList.add('active');

  const container = document.getElementById('progressContent');
  const s = computeStats();

  if (s.total_completions === 0) {
    container.innerHTML =
      '<div class="progress-empty fade-in">' +
        '<div style="font-size:2rem;margin-bottom:12px;opacity:.3">\u2E2E</div>' +
        '<p>You haven\'t tracked any activities yet.<br>Every journey starts with a single step.</p>' +
        '<a href="#catalog">\u2190 Browse the catalog</a>' +
      '</div>';
    window.scrollTo(0, 0);
    return;
  }

  let html = '';

  /* Stat cards */
  html += '<div class="stat-cards">' +
    '<div class="stat-card fade-in"><div class="stat-number">' + s.total_completions + '</div><div class="stat-label">Total completions</div></div>' +
    '<div class="stat-card fade-in" style="animation-delay:.05s"><div class="stat-number">' + s.unique_activities + '/' + s.total_activities + '</div><div class="stat-label">Activities explored</div></div>' +
    '<div class="stat-card fade-in" style="animation-delay:.1s"><div class="stat-number">' + s.this_week + '</div><div class="stat-label">This week</div></div>' +
    '<div class="stat-card fade-in" style="animation-delay:.15s"><div class="stat-number">' + s.streak_days + '</div><div class="stat-label">Day streak</div></div>' +
  '</div>';

  /* Category breakdown */
  if (s.by_category.length) {
    const maxCat = Math.max(...s.by_category.map(c => c.count));
    html += '<div class="progress-section fade-in" style="animation-delay:.2s">' +
      '<div class="progress-section-title">By category</div>' +
      '<div class="category-bars">';
    s.by_category.forEach(c => {
      const pct = Math.round((c.count / maxCat) * 100);
      const color = CAT_COLORS[c.category] || 'var(--accent)';
      html += '<div class="cat-bar-row">' +
        '<span class="cat-bar-label">' + c.category + '</span>' +
        '<div class="cat-bar-track"><div class="cat-bar-fill" style="width:' + pct + '%;background:' + color + '"></div></div>' +
        '<span class="cat-bar-count">' + c.count + '</span>' +
      '</div>';
    });
    html += '</div></div>';
  }

  /* Recent activity */
  if (s.recent.length) {
    html += '<div class="progress-section fade-in" style="animation-delay:.25s">' +
      '<div class="progress-section-title">Recent activity</div>' +
      '<div class="recent-list">';
    s.recent.forEach(r => {
      const color = CAT_COLORS[r.category] || 'var(--accent)';
      html += '<div class="recent-item">' +
        '<span class="recent-dot" style="background:' + color + '"></span>' +
        '<span class="recent-name" onclick="showDetail(' + r.activity_id + ')">' + esc(r.name) + '</span>' +
        '<span class="recent-notes">' + (r.notes ? esc(r.notes) : '') + '</span>' +
        '<span class="recent-date">' + formatDate(r.completed_at) + '</span>' +
      '</div>';
    });
    html += '</div></div>';
  }

  container.innerHTML = html;
  window.scrollTo(0, 0);
}

/* ── Util ── */
function esc(s) {
  if (!s) return '';
  const d = document.createElement('div');
  d.textContent = s;
  return d.innerHTML;
}

/* ── Init ── */
(function() {
  const saved = localStorage.getItem('ogt-theme');
  if (saved) document.documentElement.setAttribute('data-theme', saved);
  updateThemeBtn(document.documentElement.getAttribute('data-theme'));

  document.getElementById('seasonFilter').onchange = applyFilters;
  document.getElementById('durationFilter').onchange = applyFilters;
  document.getElementById('settingFilter').onchange = applyFilters;
  document.getElementById('searchInput').oninput = function() {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(applyFilters, 150);
  };

  fetchActivities().then(() => {
    if (location.hash) handleHash();
  });

  window.addEventListener('hashchange', handleHash);
})();
</script>
</body>
</html>
